;-------------------------------------------------
;与えたバージョン文字列に対応するバージョン数値の取得
;-------------------------------------------------
@GET_VERSION_VALUE(バージョン文字列)
#FUNCTION
#DIMS バージョン文字列
;RESULT退避
LOCAL = RESULT
SPLIT バージョン文字列, ".", LOCALS
RESULT = LOCAL

RETURNF TOINT(LOCALS:0) * 10000 + TOINT(LOCALS:1) * 100 + TOINT(LOCALS:2)

;-------------------------------------------------
;与えたバージョン文字列と今のバージョンを比較し、アプデが必要か調べる
;-------------------------------------------------
@CHECK_UPDATE(バージョン文字列)
#FUNCTION
#DIMS バージョン文字列

RETURNF LASTLOAD_VERSION < GET_VERSION_VALUE(バージョン文字列)

;-------------------------------------------------
;セーブデータのアップデート処理
;-------------------------------------------------
@UPDATE

IF CHECK_UPDATE("1.1.0")
	CALL COLORPRINT("Ver1.1.0", カラー_注意, "W")
	PRINTFORML + AIによる訓練
	PRINTFORML + 口上デイリー
	PRINTFORML + スキル
	PRINTFORML + 能力計算式が平方根ベースから比例ベースに（低能力で弱く、高能力で強く）
ENDIF

IF CHECK_UPDATE("1.1.2")
	CALL COLORPRINT("Ver1.1.2", カラー_注意, "W")
	PRINTFORML + 危険日が5期に一度に変更
	PRINTFORML   ランダムに振りなおされます
	FOR LOCAL, 0, CHARANUM
		TALENT:LOCAL:危険日 = RAND:5
	NEXT
ENDIF

IF CHECK_UPDATE("1.2.0")
	CALL COLORPRINT("Ver1.2.0", カラー_注意, "W")
	PRINTFORML + 口上デイリーの内部的な作り直し
	PRINTFORML + スキル・口上デイリー
	PRINTFORML + 都市による火力支援追加
ENDIF

IF CHECK_UPDATE("1.3.0")
	CALL COLORPRINT("Ver1.3.0", カラー_注意, "W")
	PRINTFORML + 素質「妾」追加。「正妻」取得者がいる状態で婚姻の儀実行で取得可
	PRINTFORML + 自動調教の微妙な拡張
ENDIF

IF CHECK_UPDATE("1.4.0")
	CALL COLORPRINT("Ver1.4.0", カラー_注意, "W")
	PRINTFORML + コマンド実行回数の扱いが内部的に変更
	PRINTFORML + スキル「暗殺」は強すぎたのでデバフスキル「闇討ち」に変更
	PRINTFORML + 性交系コマンドの追加
	FOR LOCAL, 0, CHARANUM
		FOR LOCAL:1, 0, 300
			COM_EXP:LOCAL:(LOCAL:1 + 1000) = COM_EXP:LOCAL:(LOCAL:1 + 300)
			COM_EXP:LOCAL:(LOCAL:1 + 2000) = COM_EXP:LOCAL:(LOCAL:1 + 600)
			COM_TENDENCY:LOCAL:(LOCAL:1 + 1000) = COM_TENDENCY:LOCAL:(LOCAL:1 + 300)
			COM_TENDENCY:LOCAL:(LOCAL:1 + 2000) = COM_TENDENCY:LOCAL:(LOCAL:1 + 600)
			COM_EXP:LOCAL:(LOCAL:1 + 300) = 0
			COM_EXP:LOCAL:(LOCAL:1 + 600) = 0
			COM_TENDENCY:LOCAL:(LOCAL:1 + 300) = 0
			COM_TENDENCY:LOCAL:(LOCAL:1 + 600) = 0
		NEXT
	NEXT
ENDIF
