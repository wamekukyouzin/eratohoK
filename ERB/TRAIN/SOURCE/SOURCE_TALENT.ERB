;SOURCE_CHECKで使用する関数(TALENT系)

;-------------------------------------------------
;素質などによるパラメータ上昇の補正(快楽系)
;-------------------------------------------------
@UP_TALENT_CHECK1(ARG:0)
IF TALENT:(ARG:0):自制心 && !GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_淫乱)
	IF !IS_FALLEN(ARG:0)
		TIMES CUP:(ARG:0):快Ｃ, 0.75
		TIMES CUP:(ARG:0):快Ｖ, 0.70
		TIMES CUP:(ARG:0):快Ａ, 0.80
		TIMES CUP:(ARG:0):快Ｂ, 0.60
		TIMES CUP:(ARG:0):快Ｍ, 0.80
		TIMES CUP:(ARG:0):快Ｕ, 0.80
	ENDIF
ENDIF

;機嫌の影響
SELECTCASE TOSTR_EMOTION(ARG:0)
	CASE "幸"
		TIMES CUP:(ARG:0):快Ｃ, 1.30
		TIMES CUP:(ARG:0):快Ｖ, 1.30
		TIMES CUP:(ARG:0):快Ａ, 1.30
		TIMES CUP:(ARG:0):快Ｂ, 1.30
		TIMES CUP:(ARG:0):快Ｍ, 1.30
		TIMES CUP:(ARG:0):快Ｕ, 1.30
	CASE "悦"
		TIMES CUP:(ARG:0):快Ｃ, 1.20
		TIMES CUP:(ARG:0):快Ｖ, 1.20
		TIMES CUP:(ARG:0):快Ａ, 1.20
		TIMES CUP:(ARG:0):快Ｂ, 1.20
		TIMES CUP:(ARG:0):快Ｍ, 1.20
		TIMES CUP:(ARG:0):快Ｕ, 1.20
	CASE "良"
		TIMES CUP:(ARG:0):快Ｃ, 1.10
		TIMES CUP:(ARG:0):快Ｖ, 1.10
		TIMES CUP:(ARG:0):快Ａ, 1.10
		TIMES CUP:(ARG:0):快Ｂ, 1.10
		TIMES CUP:(ARG:0):快Ｍ, 1.10
		TIMES CUP:(ARG:0):快Ｕ, 1.10
	CASE "恨"
	CASE "怒"
	CASE "憤"
	CASE "鬱"
		TIMES CUP:(ARG:0):快Ｃ, 0.60
		TIMES CUP:(ARG:0):快Ｖ, 0.60
		TIMES CUP:(ARG:0):快Ａ, 0.60
		TIMES CUP:(ARG:0):快Ｂ, 0.60
		TIMES CUP:(ARG:0):快Ｍ, 0.60
		TIMES CUP:(ARG:0):快Ｕ, 0.60
	CASE "悲"
		TIMES CUP:(ARG:0):快Ｃ, 0.75
		TIMES CUP:(ARG:0):快Ｖ, 0.75
		TIMES CUP:(ARG:0):快Ａ, 0.75
		TIMES CUP:(ARG:0):快Ｂ, 0.75
		TIMES CUP:(ARG:0):快Ｍ, 0.75
		TIMES CUP:(ARG:0):快Ｕ, 0.75
	CASE "憂"
		TIMES CUP:(ARG:0):快Ｃ, 0.80
		TIMES CUP:(ARG:0):快Ｖ, 0.80
		TIMES CUP:(ARG:0):快Ａ, 0.80
		TIMES CUP:(ARG:0):快Ｂ, 0.80
		TIMES CUP:(ARG:0):快Ｍ, 0.80
		TIMES CUP:(ARG:0):快Ｕ, 0.80
	CASE "狂"
	CASE "恐"
	CASE "怯"
	CASE "壊"
		TIMES CUP:(ARG:0):快Ｃ, 0.50
		TIMES CUP:(ARG:0):快Ｖ, 0.50
		TIMES CUP:(ARG:0):快Ａ, 0.50
		TIMES CUP:(ARG:0):快Ｂ, 0.50
		TIMES CUP:(ARG:0):快Ｍ, 0.50
		TIMES CUP:(ARG:0):快Ｕ, 0.50
	CASE "虚"
		TIMES CUP:(ARG:0):快Ｃ, 0.85
		TIMES CUP:(ARG:0):快Ｖ, 0.85
		TIMES CUP:(ARG:0):快Ａ, 0.85
		TIMES CUP:(ARG:0):快Ｂ, 0.85
		TIMES CUP:(ARG:0):快Ｍ, 0.85
		TIMES CUP:(ARG:0):快Ｕ, 0.85
ENDSELECT

;男性・男の娘
IF !HAS_VAGINA(ARG:0)
	TIMES CUP:(ARG:0):快Ａ, 1.20
ENDIF

;目隠し
IF IS_EQUIP_TARGET(ARG:0, 84)
	TIMES CUP:(ARG:0):快Ｃ, 1.10
	TIMES CUP:(ARG:0):快Ｖ, 1.10
	TIMES CUP:(ARG:0):快Ａ, 1.10
	TIMES CUP:(ARG:0):快Ｂ, 1.10
	TIMES CUP:(ARG:0):快Ｍ, 1.10
	TIMES CUP:(ARG:0):快Ｕ, 1.10
ENDIF

IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_浮気癖)
	IF ((IS_MPLY(MASTER) && IS_MTAR(ARG:0)) || (IS_MPLY(ARG:0) && IS_MTAR(MASTER)))
		TIMES CUP:(ARG:0):快Ｃ, 0.7
		TIMES CUP:(ARG:0):快Ｖ, 0.7
		TIMES CUP:(ARG:0):快Ａ, 0.7
		TIMES CUP:(ARG:0):快Ｂ, 0.7
		TIMES CUP:(ARG:0):快Ｍ, 0.7
		TIMES CUP:(ARG:0):快Ｕ, 0.7
	ELSE
		TIMES CUP:(ARG:0):快Ｃ, 1.15
		TIMES CUP:(ARG:0):快Ｖ, 1.15
		TIMES CUP:(ARG:0):快Ａ, 1.15
		TIMES CUP:(ARG:0):快Ｂ, 1.15
		TIMES CUP:(ARG:0):快Ｍ, 1.15
		TIMES CUP:(ARG:0):快Ｕ, 1.15
	ENDIF
ENDIF

;-------------------------------------------------
;素質などによるパラメータ上昇の補正(快楽系以外)
;-------------------------------------------------
@UP_TALENT_CHECK2(ARG:0)
;TRAINの外で欲情がリセットされないままこの関数が呼び出されたことでオーバーフローの可能性があった
;機嫌系を別関数に切り出してこっちから呼び出す

IF TALENT:(ARG:0):反抗的
	TIMES CUP:(ARG:0):欲情, 0.70
ENDIF

IF TALENT:(ARG:0):気丈
	TIMES CUP:(ARG:0):欲情, 0.8
ENDIF

IF TALENT:(ARG:0):大人しい
	TIMES CUP:(ARG:0):欲情, 0.8
ENDIF

IF TALENT:(ARG:0):無関心
	TIMES CUP:(ARG:0):欲情, 0.7
ENDIF

IF TALENT:(ARG:0):感情乏しい
	TIMES CUP:(ARG:0):欲情, 0.7
ENDIF

IF TALENT:(ARG:0):抑圧
	CUP:(ARG:0):欲情 = CUP:(ARG:0):欲情 * (125 - YOKUATSU_RATE(ARG:0)) / 125
ENDIF

IF TALENT:(ARG:0):解放
	TIMES CUP:(ARG:0):欲情, 1.5
ENDIF

IF TALENT:(ARG:0):孤高
	TIMES CUP:(ARG:0):欲情, 0.80
ENDIF

SIF TALENT:(ARG:0):快感に素直
	TIMES CUP:(ARG:0):欲情, 1.8
SIF TALENT:(ARG:0):快感の否定
	TIMES CUP:(ARG:0):欲情, 0.7

IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_浮気癖)
	IF ((IS_MPLY(MASTER) && IS_MTAR(ARG:0)) || (IS_MPLY(ARG:0) && IS_MTAR(MASTER)))
		TIMES CUP:(ARG:0):欲情, 0.8
	ELSE
		TIMES CUP:(ARG:0):欲情, 1.5
	ENDIF
ENDIF


;機嫌の影響
SELECTCASE TOSTR_EMOTION(ARG:0)
	CASE "幸"
		TIMES CUP:(ARG:0):欲情, 1.15
	CASE "悦"
		TIMES CUP:(ARG:0):欲情, 1.10
	CASE "良"
		TIMES CUP:(ARG:0):欲情, 1.05
	CASE "恨"
	CASE "怒"
	CASE "憤"
	CASE "鬱"
		TIMES CUP:(ARG:0):欲情, 0.30
	CASE "悲"
		TIMES CUP:(ARG:0):欲情, 0.60
	CASE "憂"
		TIMES CUP:(ARG:0):欲情, 0.80
	CASE "狂"
	CASE "恐"
	CASE "怯"
	CASE "壊"
		TIMES CUP:(ARG:0):欲情, 0.20
	CASE "虚"
		TIMES CUP:(ARG:0):欲情, 0.60
ENDSELECT

;機嫌系を後から呼び出す
CALL UP_TALENT_CHECK3(ARG:0)


;素質などによるパラメータ上昇の補正(機嫌系)
;TRAINの外でCUPを安全に扱うために機嫌を隔離
@UP_TALENT_CHECK3(ARG:0)
;目隠し
IF IS_EQUIP_TARGET(ARG:0, 84)
	TIMES CUP:(ARG:0):怖主, 1.20
ENDIF	

IF TALENT:(ARG:0):臆病
	IF CUP:(ARG:0):怒主 > 0
		TIMES CUP:(ARG:0):怒主, 0.75
	ENDIF
	IF CUP:(ARG:0):哀主 > 0
		TIMES CUP:(ARG:0):哀主, 1.2
	ENDIF
	IF CUP:(ARG:0):怖主 > 0
		TIMES CUP:(ARG:0):怖主, 1.3
	ENDIF
ENDIF

IF TALENT:(ARG:0):反抗的
	IF CUP:(ARG:0):怒主 > 0
		IF TALENT:(ARG:0):子供人質
			TIMES CUP:(ARG:0):怒主, 1.2
		ELSE
			TIMES CUP:(ARG:0):怒主, 1.4
		ENDIF
	ENDIF
ENDIF

IF TALENT:(ARG:0):気丈
	IF CUP:(ARG:0):怒主 > 0
		IF TALENT:(ARG:0):子供人質
			TIMES CUP:(ARG:0):怒主, 1.1
		ELSE
			TIMES CUP:(ARG:0):怒主, 1.2
		ENDIF
	ENDIF
	IF CUP:(ARG:0):哀主 > 0
		TIMES CUP:(ARG:0):哀主, 0.7
	ENDIF
	IF CUP:(ARG:0):怖主 > 0
		TIMES CUP:(ARG:0):怖主, 0.7
	ENDIF
ENDIF

IF TALENT:(ARG:0):素直
	IF CUP:(ARG:0):怒主 > 0
		TIMES CUP:(ARG:0):怒主, 0.8
	ENDIF
ENDIF

IF TALENT:(ARG:0):大人しい
	IF CUP:(ARG:0):怒主 > 0
		TIMES CUP:(ARG:0):怒主, 0.6
	ENDIF
	IF CUP:(ARG:0):哀主 > 0
		TIMES CUP:(ARG:0):哀主, 1.5
	ENDIF
ENDIF

IF TALENT:(ARG:0):プライド高い
	IF CUP:(ARG:0):怒主 > 0
		IF TALENT:(ARG:0):子供人質
			TIMES CUP:(ARG:0):怒主, 1.2
		ELSE
			TIMES CUP:(ARG:0):怒主, 1.4
		ENDIF
	ENDIF
	IF CUP:(ARG:0):怖主 > 0
		TIMES CUP:(ARG:0):怖主, 0.8
	ENDIF
ENDIF

IF TALENT:(ARG:0):プライド低い
	IF CUP:(ARG:0):怒主 > 0
		TIMES CUP:(ARG:0):怒主, 0.8
	ENDIF
	IF CUP:(ARG:0):怖主 > 0
		TIMES CUP:(ARG:0):怖主, 1.2
	ENDIF
ENDIF

IF TALENT:(ARG:0):無関心
	TIMES CUP:(ARG:0):怒主, 0.7
	TIMES CUP:(ARG:0):哀主, 0.7
	TIMES CUP:(ARG:0):怖主, 0.7
ENDIF

IF TALENT:(ARG:0):感情乏しい
	TIMES CUP:(ARG:0):怒主, 0.5
	TIMES CUP:(ARG:0):哀主, 0.5
	TIMES CUP:(ARG:0):怖主, 0.5
ENDIF

IF TALENT:(ARG:0):好奇心
	IF CUP:(ARG:0):怒主 > 0
		TIMES CUP:(ARG:0):怒主, 0.9
	ENDIF
	IF CUP:(ARG:0):怖主 > 0
		TIMES CUP:(ARG:0):怖主, 0.9
	ENDIF
ENDIF

IF TALENT:(ARG:0):保守的
	IF CUP:(ARG:0):怒主 > 0
		IF TALENT:(ARG:0):子供人質
			TIMES CUP:(ARG:0):怒主, 1.1
		ELSE
			TIMES CUP:(ARG:0):怒主, 1.2
		ENDIF
	ENDIF
	IF CUP:(ARG:0):怖主 > 0
		TIMES CUP:(ARG:0):怖主, 1.20
	ENDIF
ENDIF

IF TALENT:(ARG:0):楽観的
	IF CUP:(ARG:0):哀主 > 0
		TIMES CUP:(ARG:0):哀主, 0.6
	ENDIF
	IF CUP:(ARG:0):怖主 > 0
		TIMES CUP:(ARG:0):怖主, 0.80
	ENDIF
ENDIF

IF TALENT:(ARG:0):悲観的
	IF CUP:(ARG:0):哀主 > 0
		TIMES CUP:(ARG:0):哀主, 1.5
	ENDIF
	IF CUP:(ARG:0):怖主 > 0
		TIMES CUP:(ARG:0):怖主, 1.1
	ENDIF
ENDIF

IF TALENT:(ARG:0):抑圧
	CUP:(ARG:0):怒主 = CUP:(ARG:0):怒主 * (150 - YOKUATSU_RATE(ARG:0)) / 150
	CUP:(ARG:0):哀主 = CUP:(ARG:0):哀主 * (150 - YOKUATSU_RATE(ARG:0)) / 150
	CUP:(ARG:0):怖主 = CUP:(ARG:0):怖主 * (150 - YOKUATSU_RATE(ARG:0)) / 150
ENDIF

IF TALENT:(ARG:0):解放
	TIMES CUP:(ARG:0):怒主, 1.15
	TIMES CUP:(ARG:0):哀主, 1.15
	TIMES CUP:(ARG:0):怖主, 0.9
ENDIF

IF TALENT:(ARG:0):孤高
	TIMES CUP:(ARG:0):哀主, 0.75
	TIMES CUP:(ARG:0):怖主, 0.5
	IF CUP:(ARG:0):怒主 > 0
		IF TALENT:(ARG:0):子供人質
			TIMES CUP:(ARG:0):怒主, 1.15
		ELSE
			TIMES CUP:(ARG:0):怒主, 1.2
		ENDIF
	ENDIF
ENDIF

IF TALENT:(ARG:0):Ｓ気質
	IF CUP:(ARG:0):怒主 > 0
		IF TALENT:(ARG:0):子供人質
			TIMES CUP:(ARG:0):怒主, 1.1
		ELSE
			TIMES CUP:(ARG:0):怒主, 1.15
		ENDIF
	ENDIF
	IF CUP:(ARG:0):怖主 > 0
		TIMES CUP:(ARG:0):怖主, 0.80
	ENDIF
ENDIF

IF TALENT:(ARG:0):小悪魔
	IF CUP:(ARG:0):怒主 > 0
		TIMES CUP:(ARG:0):怒主, 0.90
	ENDIF
	IF CUP:(ARG:0):哀主 > 0
		TIMES CUP:(ARG:0):哀主, 0.60
	ENDIF
	IF CUP:(ARG:0):怖主 > 0
		TIMES CUP:(ARG:0):怖主, 0.60
	ENDIF
ENDIF

IF (IS_MPLY(ARG:0) && IS_MTAR(MASTER)) || (IS_MTAR(ARG:0) && IS_MPLY(MASTER))
	IF TALENT:(ARG:0):親愛
		CUP:(ARG:0):怒主 = SET_RATE_EMOTION(CUP:(ARG:0):怒主,  60, 200)
		CUP:(ARG:0):哀主 = SET_RATE_EMOTION(CUP:(ARG:0):哀主,  60, 200)
		CUP:(ARG:0):怖主 = SET_RATE_EMOTION(CUP:(ARG:0):怖主,  60, 200)
	ELSEIF TALENT:(ARG:0):恋慕 || TALENT:(ARG:0):親友
		CUP:(ARG:0):怒主 = SET_RATE_EMOTION(CUP:(ARG:0):怒主,  80, 150)
		CUP:(ARG:0):哀主 = SET_RATE_EMOTION(CUP:(ARG:0):哀主,  80, 150)
		CUP:(ARG:0):怖主 = SET_RATE_EMOTION(CUP:(ARG:0):怖主,  80, 150)
	ELSEIF TALENT:(ARG:0):恋人
		CUP:(ARG:0):怒主 = SET_RATE_EMOTION(CUP:(ARG:0):怒主,  80, 120)
		CUP:(ARG:0):哀主 = SET_RATE_EMOTION(CUP:(ARG:0):哀主,  80, 120)
		CUP:(ARG:0):怖主 = SET_RATE_EMOTION(CUP:(ARG:0):怖主,  80, 120)
	ENDIF

	IF TALENT:(ARG:0):隷属
		CUP:(ARG:0):怒主 = SET_RATE_EMOTION(CUP:(ARG:0):怒主,  10, 300)
		CUP:(ARG:0):哀主 = SET_RATE_EMOTION(CUP:(ARG:0):哀主,  20, 250)
		CUP:(ARG:0):怖主 = SET_RATE_EMOTION(CUP:(ARG:0):怖主, 150,  50)
	ELSEIF TALENT:(ARG:0):服従
		CUP:(ARG:0):怒主 = SET_RATE_EMOTION(CUP:(ARG:0):怒主,  50, 200)
		CUP:(ARG:0):哀主 = SET_RATE_EMOTION(CUP:(ARG:0):哀主,  50, 200)
		CUP:(ARG:0):怖主 = SET_RATE_EMOTION(CUP:(ARG:0):怖主, 125,  75)
	ENDIF

	IF TALENT:(ARG:0):所有者
		CUP:(ARG:0):怒主 = SET_RATE_EMOTION(CUP:(ARG:0):怒主,  60, 200)
		CUP:(ARG:0):哀主 = SET_RATE_EMOTION(CUP:(ARG:0):哀主,  60, 200)
		CUP:(ARG:0):怖主 = SET_RATE_EMOTION(CUP:(ARG:0):怖主,  60, 200)
	ELSEIF TALENT:(ARG:0):主人
		CUP:(ARG:0):怒主 = SET_RATE_EMOTION(CUP:(ARG:0):怒主,  80, 150)
		CUP:(ARG:0):哀主 = SET_RATE_EMOTION(CUP:(ARG:0):哀主,  80, 150)
		CUP:(ARG:0):怖主 = SET_RATE_EMOTION(CUP:(ARG:0):怖主,  80, 150)
	ENDIF

	IF TALENT:(ARG:0):烙印
		CUP:(ARG:0):怒主 = SET_RATE_EMOTION(CUP:(ARG:0):怒主,  75, 125)
		CUP:(ARG:0):怖主 = SET_RATE_EMOTION(CUP:(ARG:0):怖主, 110,  75)
	ENDIF
ENDIF

;Ａ快楽による補正
LOCAL:0 = CUP:(ARG:0):快Ａ
IF LOCAL:0 >= 12000
	IF CUP:(ARG:0):怒主 > 0
		TIMES CUP:(ARG:0):怒主, 0.70
	ENDIF
ELSEIF LOCAL:0 >= 8000
	IF CUP:(ARG:0):怒主 > 0
		TIMES CUP:(ARG:0):怒主, 0.75
	ENDIF
ELSEIF LOCAL:0 >= 5000
	IF CUP:(ARG:0):怒主 > 0
		TIMES CUP:(ARG:0):怒主, 0.80
	ENDIF
ELSEIF LOCAL:0 >= 3000
	IF CUP:(ARG:0):怒主 > 0
		TIMES CUP:(ARG:0):怒主, 0.85
	ENDIF
ELSEIF LOCAL:0 >= 2000
	IF CUP:(ARG:0):怒主 > 0
		TIMES CUP:(ARG:0):怒主, 0.90
	ENDIF
ELSEIF LOCAL:0 >= 1000
	IF CUP:(ARG:0):怒主 > 0
		TIMES CUP:(ARG:0):怒主, 0.95
	ENDIF
ENDIF

;機嫌の影響
SELECTCASE TOSTR_EMOTION(ARG:0)
	CASE "幸"
	CASE "悦"
	CASE "良"
	CASE "恨"
	CASE "怒"
	CASE "憤"
	CASE "鬱"
	CASE "悲"
	CASE "憂"
	CASE "狂"
	CASE "恐"
	CASE "怯"
	CASE "壊"
		CUP:(ARG:0):怒主 = 0
		CUP:(ARG:0):哀主 = 0
		CUP:(ARG:0):怖主 = 0
	CASE "虚"
ENDSELECT

;精神力の影響
IF MAXBASE:(ARG:0):精神力 > 0
	LOCAL:0 = BASE:(ARG:0):精神力 * 100 / MAXBASE:(ARG:0):精神力
ELSE
	LOCAL:0 = 100
ENDIF
IF LOCAL:0 < 50
	TIMES CUP:(ARG:0):怒主, 0.10
	TIMES CUP:(ARG:0):哀主, 0.10
	TIMES CUP:(ARG:0):怖主, 1.7
ELSEIF LOCAL:0 < 75
	TIMES CUP:(ARG:0):怒主, 0.50
	TIMES CUP:(ARG:0):哀主, 0.50
	TIMES CUP:(ARG:0):怖主, 1.25
ENDIF

;酔いの影響
IF PALAM:(ARG:0):酔い >= 150
	CUP:(ARG:0):怒主 = MIN(CUP:(ARG:0):怒主 * (15000 - PALAM:(ARG:0):酔い) / 15000, CUP:(ARG:0):怒主) - PALAM:(ARG:0):酔い / 150
	CUP:(ARG:0):哀主 = MIN(CUP:(ARG:0):哀主 * (15000 - PALAM:(ARG:0):酔い) / 15000, CUP:(ARG:0):哀主) - PALAM:(ARG:0):酔い / 150
	CUP:(ARG:0):怖主 = MIN(CUP:(ARG:0):怖主 * (15000 - PALAM:(ARG:0):酔い) / 15000, CUP:(ARG:0):怖主) - PALAM:(ARG:0):酔い / 150
ENDIF

IF TALENT:(ARG:0):抑圧
	;全ての感情が自動的に0に近づく
	CUP:(ARG:0):怒主 -= SIGN(PALAM:(ARG:0):怒主 + CUP:(ARG:0):怒主) * MIN(100, ABS(PALAM:(ARG:0):怒主 + CUP:(ARG:0):怒主))
	CUP:(ARG:0):哀主 -= SIGN(PALAM:(ARG:0):哀主 + CUP:(ARG:0):哀主) * MIN(100, ABS(PALAM:(ARG:0):哀主 + CUP:(ARG:0):哀主))
	CUP:(ARG:0):怖主 -= SIGN(PALAM:(ARG:0):怖主 + CUP:(ARG:0):怖主) * MIN(100, ABS(PALAM:(ARG:0):怖主 + CUP:(ARG:0):怖主))
	CUP:(ARG:0):怒外 -= SIGN(PALAM:(ARG:0):怒外 + CUP:(ARG:0):怒外) * MIN(100, ABS(PALAM:(ARG:0):怒外 + CUP:(ARG:0):怒外))
	CUP:(ARG:0):哀外 -= SIGN(PALAM:(ARG:0):哀外 + CUP:(ARG:0):哀外) * MIN(100, ABS(PALAM:(ARG:0):哀外 + CUP:(ARG:0):哀外))
	CUP:(ARG:0):怖外 -= SIGN(PALAM:(ARG:0):怖外 + CUP:(ARG:0):怖外) * MIN(100, ABS(PALAM:(ARG:0):怖外 + CUP:(ARG:0):怖外))
ENDIF

;ツンデレ＆恋慕＆非恋人＆「会いに行く」＆非ウフフ
IF TALENT:(ARG:0):ツンデレ && !IS_LOVER(ARG:0) && !IS_SLAVE(ARG:0) && FLAG:調教モード == 0 && !FLAG:ウフフフラグ
	;怒・哀の感情が下がらない
	CUP:(ARG:0):怒主 = MAX(CUP:(ARG:0):怒主, 0)
	CUP:(ARG:0):哀主 = MAX(CUP:(ARG:0):哀主, 0)
ENDIF
;-------------------------------------------------
;素質<抑圧>による諸々の補正率を返す関数 ARG:0は対象のキャラ番号
;-------------------------------------------------
@YOKUATSU_RATE(ARG:0)
#FUNCTION
IF CFLAG:(ARG:0):3 < 10
	RETURNF 70
ELSEIF CFLAG:(ARG:0):3 < 50
	RETURNF 60
ELSEIF CFLAG:(ARG:0):3 < 100
	RETURNF 50
ELSEIF CFLAG:(ARG:0):3 < 200
	RETURNF 40
ELSEIF CFLAG:(ARG:0):3 < 300
	RETURNF 30
ELSEIF CFLAG:(ARG:0):3 < 500
	RETURNF 20
ELSEIF CFLAG:(ARG:0):3 < 800
	RETURNF 10
ELSEIF CFLAG:(ARG:0):3 < 1500
	RETURNF 5
ELSEIF CFLAG:(ARG:0):3 < 3000
	RETURNF 1
ENDIF
RETURNF 1

;-------------------------------------------------
;素質<孤高>による諸々の補正率を返す関数 ARG:0は対象のキャラ番号
;-------------------------------------------------
@KOKOU_RATE(ARG:0)
#FUNCTION
IF TALENT:(ARG:0):子供人質
	IF CFLAG:(ARG:0):3 < 10
		RETURNF 49
	ELSEIF CFLAG:(ARG:0):3 < 50
		RETURNF 42
	ELSEIF CFLAG:(ARG:0):3 < 100
		RETURNF 35
	ELSEIF CFLAG:(ARG:0):3 < 200
		RETURNF 28
	ELSEIF CFLAG:(ARG:0):3 < 300
		RETURNF 21
	ELSEIF CFLAG:(ARG:0):3 < 500
		RETURNF 14
	ELSEIF CFLAG:(ARG:0):3 < 800
		RETURNF 7
	ELSEIF CFLAG:(ARG:0):3 < 1500
		RETURNF 4
	ELSEIF CFLAG:(ARG:0):3 < 3000
		RETURNF 1
	ENDIF
ELSE
	IF CFLAG:(ARG:0):3 < 10
		RETURNF 70
	ELSEIF CFLAG:(ARG:0):3 < 50
		RETURNF 60
	ELSEIF CFLAG:(ARG:0):3 < 100
		RETURNF 50
	ELSEIF CFLAG:(ARG:0):3 < 200
		RETURNF 40
	ELSEIF CFLAG:(ARG:0):3 < 300
		RETURNF 30
	ELSEIF CFLAG:(ARG:0):3 < 500
		RETURNF 20
	ELSEIF CFLAG:(ARG:0):3 < 800
		RETURNF 10
	ELSEIF CFLAG:(ARG:0):3 < 1500
		RETURNF 5
	ELSEIF CFLAG:(ARG:0):3 < 3000
		RETURNF 1
	ENDIF
ENDIF
RETURNF 1

;-------------------------------------------------
;値ARG:0に、正なら(ARG:1)/100を、負なら(ARG:2)/100を掛ける関数
;-------------------------------------------------
@SET_RATE_EMOTION(ARG:0, ARG:1, ARG:2)
#FUNCTION
IF ARG:0 >= 0
	RETURNF ARG:0 * ARG:1 / 100
ENDIF
RETURNF -(ABS(ARG:0) * ARG:2 / 100)
