;各ソースによる影響の計算

;-------------------------------------------------
;快Ｃのソース
;-------------------------------------------------
@CALC_SOURCE0(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):快Ｃ
LOCAL:1 = SOURCE:(ARG:0):快Ｃ
LOCAL:2 = SOURCE:(ARG:0):快Ｃ / 5
LOCAL:5 = SOURCE:(ARG:0):快Ｃ

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｃ感, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｃ感, LOCAL:1)

;欲情による共通補正
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):欲望
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):欲望 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):Ｃ敏感
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ENDIF

IF TALENT:(ARG:0):Ｃ鈍感
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_淫核)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;媚薬使用中
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;桃源香使用中
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;体力0による行動不能
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;気力0による失神中
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;睡眠中
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):欲情 += LOCAL:1

IF TALENT:(ARG:0):恋慕 && TALENT:(ARG:0):恋人 && TALENT:(ARG:0):合意
	TIMES LOCAL:2, 0.25
ELSEIF (TALENT:(ARG:0):恋慕 || TALENT:(ARG:0):恋人) && TALENT:(ARG:0):合意
	TIMES LOCAL:2, 0.50
ENDIF

IF TALENT:(ARG:0):孤高
	CUP:(ARG:0):怒主 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):抑圧 || TALENT:(ARG:0):快感の否定
	CUP:(ARG:0):哀主 += LOCAL:2
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):射精 += LOCAL:5 / 5
ENDIF

CUP:(ARG:0):快Ｃ += LOCAL:0
CUP:(ARG:0):潮吹き += SQRT(LOCAL:0 * 400)

IF TALENT:(ARG:0):母乳体質
	CUP:(ARG:0):噴乳 += CALC_SOURCE_MILK(ARG:0, LOCAL:5 / 5)
ENDIF

;-------------------------------------------------
;快Ｐのソース
;-------------------------------------------------
@CALC_SOURCE9(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):快Ｐ
LOCAL:1 = SOURCE:(ARG:0):快Ｐ
LOCAL:2 = SOURCE:(ARG:0):快Ｐ / 5
LOCAL:5 = SOURCE:(ARG:0):快Ｐ

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｃ感, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｃ感, LOCAL:1)

;欲情による共通補正
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):欲望
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):欲望 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):Ｃ敏感
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ENDIF

IF TALENT:(ARG:0):Ｃ鈍感
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_淫核)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;媚薬使用中
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;桃源香使用中
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;体力0による行動不能
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;気力0による失神中
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;睡眠中
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):欲情 += LOCAL:1

IF TALENT:(ARG:0):恋慕 || TALENT:(ARG:0):恋人
	TIMES LOCAL:2, 0.50
ENDIF

IF TALENT:(ARG:0):孤高
	CUP:(ARG:0):怒主 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):抑圧 || TALENT:(ARG:0):快感の否定
	CUP:(ARG:0):哀主 += LOCAL:2
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):射精 += LOCAL:5
ENDIF

CUP:(ARG:0):快Ｃ += LOCAL:0 / 15

IF TALENT:(ARG:0):母乳体質
	CUP:(ARG:0):噴乳 += CALC_SOURCE_MILK(ARG:0, LOCAL:5 / 5)
ENDIF

;獣変化中
IF TALENT:(ARG:0):動物耳 || TALENT:(ARG:0):しっぽ
	;好感度上昇
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):10 += 2500
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):10 += 1700
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):10 += 1200
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):10 += 800
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):10 += 600
	ENDIF

	;依存度上昇
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):11 += 2500
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):11 += 1700
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):11 += 1200
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):11 += 800
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):11 += 600
	ENDIF
ENDIF

;-------------------------------------------------
;快Ｖのソース
;-------------------------------------------------
@CALC_SOURCE1(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):快Ｖ
LOCAL:1 = SOURCE:(ARG:0):快Ｖ
LOCAL:2 = SOURCE:(ARG:0):快Ｖ / 5
LOCAL:5 = SOURCE:(ARG:0):快Ｖ

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｖ感, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｖ感, LOCAL:1)

;欲情による共通補正
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):欲望
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):欲望 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):Ｖ敏感
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ENDIF

IF TALENT:(ARG:0):Ｖ鈍感
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_淫壷)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;媚薬使用中
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;桃源香使用中
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;体力0による行動不能
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;気力0による失神中
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;睡眠中
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):快Ｖ += LOCAL:0
CUP:(ARG:0):欲情 += LOCAL:1
CUP:(ARG:0):哀主 -= LOCAL:1 / 5
CUP:(ARG:0):潮吹き += SQRT(LOCAL:0 * 400)

SIF TALENT:(ARG:0):恋慕 && TALENT:(ARG:0):恋人 && TALENT:(ARG:0):合意
	TIMES LOCAL:2, 0.50

SIF !TALENT:(ARG:0):処女
	TIMES LOCAL:2, 0.50

IF TALENT:(ARG:0):孤高
	CUP:(ARG:0):怒主 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):抑圧 || TALENT:(ARG:0):快感の否定
	CUP:(ARG:0):哀主 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):処女
	CUP:(ARG:0):怖主 += LOCAL:2
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):射精 += LOCAL:5 / 2
ENDIF

IF TALENT:(ARG:0):母乳体質
	CUP:(ARG:0):噴乳 += CALC_SOURCE_MILK(ARG:0, LOCAL:5 / 5)
ENDIF

;獣変化中
IF TALENT:(ARG:0):動物耳 || TALENT:(ARG:0):しっぽ
	;好感度上昇
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):10 += 2500
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):10 += 1700
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):10 += 1200
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):10 += 800
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):10 += 600
	ENDIF

	;依存度上昇
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):11 += 2500
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):11 += 1700
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):11 += 1200
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):11 += 800
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):11 += 600
	ENDIF

	;従属度上昇
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):12 += 1200
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):12 += 900
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):12 += 700
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):12 += 500
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):12 += 300
	ENDIF

	;支配度上昇
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):74 += 1200
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):74 += 900
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):74 += 700
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):74 += 500
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):74 += 300
	ENDIF

ELSE
	;好感度上昇
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):10 += 700
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):10 += 500
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):10 += 300
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):10 += 200
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):10 += 100
	ENDIF

	;依存度上昇
	IF LOCAL:0 >= 100000
		TCVAR:(ARG:0):11 += 700
	ELSEIF LOCAL:0 >= 20000
		TCVAR:(ARG:0):11 += 500
	ELSEIF LOCAL:0 >= 10000
		TCVAR:(ARG:0):11 += 300
	ELSEIF LOCAL:0 >= 3000
		TCVAR:(ARG:0):11 += 200
	ELSEIF LOCAL:0 >= 500
		TCVAR:(ARG:0):11 += 100
	ENDIF
ENDIF

;-------------------------------------------------
;快Ａのソース
;-------------------------------------------------
@CALC_SOURCE2(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):快Ａ
LOCAL:1 = SOURCE:(ARG:0):快Ａ
LOCAL:2 = SOURCE:(ARG:0):快Ａ / 5
LOCAL:5 = SOURCE:(ARG:0):快Ａ

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ａ感, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ａ感, LOCAL:1)


;欲情による共通補正
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):欲望
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):欲望 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):Ａ敏感
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ENDIF

IF TALENT:(ARG:0):Ａ鈍感
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_尻穴狂い)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;媚薬使用中
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;桃源香使用中
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;体力0による行動不能
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;気力0による失神中
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;睡眠中
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):快Ａ += LOCAL:0
CUP:(ARG:0):欲情 += LOCAL:1
CUP:(ARG:0):怒主 -= LOCAL:1 / 5

IF TALENT:(ARG:0):孤高
	CUP:(ARG:0):怒主 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):抑圧 || TALENT:(ARG:0):快感の否定
	CUP:(ARG:0):哀主 += LOCAL:2
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):射精 += LOCAL:5 / 2
ENDIF

IF TALENT:(ARG:0):母乳体質
	CUP:(ARG:0):噴乳 += CALC_SOURCE_MILK(ARG:0, LOCAL:5 / 5)
ENDIF

;従属度上昇
IF LOCAL:0 >= 100000
	TCVAR:(ARG:0):12 += 900
ELSEIF LOCAL:0 >= 20000
	TCVAR:(ARG:0):12 += 700
ELSEIF LOCAL:0 >= 10000
	TCVAR:(ARG:0):12 += 500
ELSEIF LOCAL:0 >= 6000
	TCVAR:(ARG:0):12 += 400
ELSEIF LOCAL:0 >= 3000
	TCVAR:(ARG:0):12 += 300
ELSEIF LOCAL:0 >= 500
	TCVAR:(ARG:0):12 += 200
ELSEIF LOCAL:0 >= 100
	TCVAR:(ARG:0):12 += 100
ENDIF

;支配度上昇
IF LOCAL:0 >= 100000
	TCVAR:(ARG:0):74 += 900
ELSEIF LOCAL:0 >= 20000
	TCVAR:(ARG:0):74 += 700
ELSEIF LOCAL:0 >= 10000
	TCVAR:(ARG:0):74 += 500
ELSEIF LOCAL:0 >= 6000
	TCVAR:(ARG:0):74 += 400
ELSEIF LOCAL:0 >= 3000
	TCVAR:(ARG:0):74 += 300
ELSEIF LOCAL:0 >= 500
	TCVAR:(ARG:0):74 += 200
ELSEIF LOCAL:0 >= 100
	TCVAR:(ARG:0):74 += 100
ENDIF

;依存度上昇
IF LOCAL:0 >= 100000
	TCVAR:(ARG:0):11 += 900
ELSEIF LOCAL:0 >= 20000
	TCVAR:(ARG:0):11 += 700
ELSEIF LOCAL:0 >= 10000
	TCVAR:(ARG:0):11 += 500
ELSEIF LOCAL:0 >= 6000
	TCVAR:(ARG:0):11 += 400
ELSEIF LOCAL:0 >= 3000
	TCVAR:(ARG:0):11 += 300
ELSEIF LOCAL:0 >= 500
	TCVAR:(ARG:0):11 += 200
ELSEIF LOCAL:0 >= 100
	TCVAR:(ARG:0):11 += 100
ENDIF

;-------------------------------------------------
;快Ｂのソース
;-------------------------------------------------
@CALC_SOURCE3(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):快Ｂ
LOCAL:1 = SOURCE:(ARG:0):快Ｂ
LOCAL:2 = SOURCE:(ARG:0):快Ｂ / 5
LOCAL:5 = SOURCE:(ARG:0):快Ｂ

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｂ感, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｂ感, LOCAL:1)

;欲情による共通補正
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):欲望
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):欲望 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):Ｂ敏感
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ENDIF

IF TALENT:(ARG:0):Ｂ鈍感
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_淫乳)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;媚薬使用中
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;桃源香使用中
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;体力0による行動不能
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;気力0による失神中
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;睡眠中
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):快Ｂ += LOCAL:0
CUP:(ARG:0):欲情 += LOCAL:1

IF TALENT:(ARG:0):恋慕 && TALENT:(ARG:0):恋人
	TIMES LOCAL:2, 0.25
ELSEIF TALENT:(ARG:0):恋慕 || TALENT:(ARG:0):恋人
	TIMES LOCAL:2, 0.50
ENDIF

SIF TALENT:(ARG:0):合意
	TIMES LOCAL:2, 0.50

IF TALENT:(ARG:0):孤高
	CUP:(ARG:0):怒主 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):抑圧 || TALENT:(ARG:0):快感の否定
	CUP:(ARG:0):哀主 += LOCAL:2
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):射精 += LOCAL:5 / 5
ENDIF

IF TALENT:(ARG:0):母乳体質
	CUP:(ARG:0):噴乳 += CALC_SOURCE_MILK(ARG:0, LOCAL:5)
ENDIF

;-------------------------------------------------
;搾乳のソース
;-------------------------------------------------
@CALC_SOURCE8(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):搾乳
LOCAL:1 = SOURCE:(ARG:0):搾乳
LOCAL:2 = SOURCE:(ARG:0):搾乳 / 5
LOCAL:5 = SOURCE:(ARG:0):搾乳

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｂ感, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｂ感, LOCAL:1)

;欲情による共通補正
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):欲望
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):欲望 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):Ｂ敏感
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ENDIF

IF TALENT:(ARG:0):Ｂ鈍感
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_淫乳)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;媚薬使用中
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;桃源香使用中
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;体力0による行動不能
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;気力0による失神中
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;睡眠中
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):快Ｂ += LOCAL:0 / 2
CUP:(ARG:0):欲情 += LOCAL:1

IF TALENT:(ARG:0):孤高
	CUP:(ARG:0):怒主 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):抑圧 || TALENT:(ARG:0):快感の否定
	CUP:(ARG:0):哀主 += LOCAL:2
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):射精 += LOCAL:5 / 10
ENDIF

IF TALENT:(ARG:0):母乳体質
	CUP:(ARG:0):噴乳 += CALC_SOURCE_MILK(ARG:0, LOCAL:5 * 5)
ENDIF

;-------------------------------------------------
;快Ｍのソース
;-------------------------------------------------
@CALC_SOURCE4(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):快Ｍ
LOCAL:1 = SOURCE:(ARG:0):快Ｍ
LOCAL:2 = SOURCE:(ARG:0):快Ｍ / 5
LOCAL:5 = SOURCE:(ARG:0):快Ｍ

LOCAL:0 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｍ感, LOCAL:0)
LOCAL:1 = CALC_SOURCE_SENSE_BASE(ABL:(ARG:0):Ｍ感, LOCAL:1)


;欲情による共通補正
LOCAL:0 = CALC_SOURCE_SENSE_ESTRUS(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):欲望
	CASE 0
		TIMES LOCAL:1, 0.10
		TIMES LOCAL:2, 1.00
	CASE 1
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.85
	CASE 2
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 0.70
	CASE 3
		TIMES LOCAL:1, 0.25
		TIMES LOCAL:2, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * ((ABL:(ARG:0):欲望 - 5) * 5 + 40) / 100
		TIMES LOCAL:2, 0.10
ENDSELECT

IF TALENT:(ARG:0):恋慕
	TIMES LOCAL:0, 1.20
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 1.20
ELSEIF TALENT:(ARG:0):親友
	TIMES LOCAL:0, 1.10
	TIMES LOCAL:1, 1.10
	TIMES LOCAL:2, 1.10
ELSEIF TALENT:(ARG:0):恋人
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.25
	TIMES LOCAL:2, 1.25
ELSEIF TALENT:(ARG:0):親愛
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.25
	TIMES LOCAL:2, 1.25
ELSEIF TALENT:(ARG:0):Ｍ敏感
	TIMES LOCAL:0, 2.00
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:5, 1.50
ELSEIF TALENT:(ARG:0):Ｍ鈍感
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.75
ENDIF

IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_蕩唇)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:5, 1.50
ENDIF

;媚薬使用中
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 1.5
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.50
ENDIF

;桃源香使用中
IF TFLAG:69
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 1.5
	TIMES LOCAL:5, 1.25
ENDIF

;体力0による行動不能
IF TCVAR:(ARG:0):51
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;気力0による失神中
IF TCVAR:(ARG:0):52
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:5, 0.20
ENDIF

;睡眠中
IF TCVAR:(ARG:0):53 == 1
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:5, 0.50
ENDIF

CUP:(ARG:0):快Ｍ += LOCAL:0
CUP:(ARG:0):欲情 += LOCAL:1

IF TALENT:(ARG:0):恋慕 && TALENT:(ARG:0):恋人
	TIMES LOCAL:2, 0.10
ELSEIF TALENT:(ARG:0):恋慕 || TALENT:(ARG:0):恋人
	TIMES LOCAL:2, 0.50
ENDIF

IF TALENT:(ARG:0):孤高
	CUP:(ARG:0):怒主 += LOCAL:2
ENDIF

IF TALENT:(ARG:0):抑圧 || TALENT:(ARG:0):快感の否定
	CUP:(ARG:0):哀主 += LOCAL:2
ENDIF

CUP:(ARG:0):怒主 -= LOCAL:1 / 3
CUP:(ARG:0):哀主 -= LOCAL:1 / 3
CUP:(ARG:0):怖主 -= LOCAL:1 / 3

;ムードの上昇
IF LOCAL:0 >= 30000
	TFLAG:37 += 9
ELSEIF LOCAL:0 >= 10000
	TFLAG:37 += 7
ELSEIF LOCAL:0 >= 3000
	TFLAG:37 += 5
ELSEIF LOCAL:0 >= 500
	TFLAG:37 += 3
ELSEIF LOCAL:0 >= 100
	TFLAG:37 += 2
ELSEIF LOCAL:0 >= 10
	TFLAG:37 += 1
ENDIF

IF HAS_PENIS(ARG:0)
	CUP:(ARG:0):射精 += LOCAL:5 / 5
ENDIF

IF TALENT:(ARG:0):母乳体質
	CUP:(ARG:0):噴乳 += CALC_SOURCE_MILK(ARG:0, LOCAL:5 / 5)
ENDIF

;-------------------------------------------------
;歓楽のソース
;-------------------------------------------------
@CALC_SOURCE10(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):歓楽

IF TALENT:(ARG:0):恋慕 || TALENT:(ARG:0):親友
	TIMES LOCAL:0, 1.30
ENDIF

IF TALENT:(ARG:0):親愛
	TIMES LOCAL:0, 1.30
ENDIF

IF TALENT:(ARG:0):恋人
	TIMES LOCAL:0, 1.15
ENDIF

CUP:(ARG:0):怒主 -= LOCAL:0
CUP:(ARG:0):哀主 -= LOCAL:0
CUP:(ARG:0):怖主 -= LOCAL:0

;好感度上昇
TCVAR:(ARG:0):10 += LOCAL:0 * 100 / 6

;ムードの上昇
TFLAG:37 += LOCAL:0 / 60

;-------------------------------------------------
;愛情のソース
;-------------------------------------------------
@CALC_SOURCE11(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):愛情
LOCAL:1 = SOURCE:(ARG:0):愛情
LOCAL:2 = SOURCE:(ARG:0):愛情

IF TALENT:(ARG:0):恋慕
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.25
ENDIF

IF TALENT:(ARG:0):親友
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.50
ENDIF

IF TALENT:(ARG:0):親愛
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 2.00
ENDIF

IF TALENT:(ARG:0):恋人
	TIMES LOCAL:0, 1.15
	TIMES LOCAL:1, 1.50
ENDIF

;欲望による欲情の補正
LOCAL:1 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:1)

;ウフフ中以外
IF !FLAG:ウフフフラグ
	TIMES LOCAL:1, 0.20
ENDIF

CUP:(ARG:0):怒主 -= LOCAL:0
CUP:(ARG:0):哀主 -= LOCAL:0
CUP:(ARG:0):怖主 -= LOCAL:0
CUP:(ARG:0):欲情 += LOCAL:1

;好感度上昇
TCVAR:(ARG:0):10 += LOCAL:2 * 100 / 8

;依存度上昇
TCVAR:(ARG:0):11 += LOCAL:2 * 100 / 12

;ムードの上昇
TFLAG:37 += LOCAL:0 / 15

;-------------------------------------------------
;優越のソース
;-------------------------------------------------
@CALC_SOURCE12(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):優越
LOCAL:1 = SOURCE:(ARG:0):優越
LOCAL:2 = SOURCE:(ARG:0):優越
LOCAL:3 = SOURCE:(ARG:0):優越

LOCAL:5 = ABL:(ARG:0):主導度Ｕ
IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_サド)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.50
ELSEIF LOCAL:5 >= 500
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.50
ELSEIF LOCAL:5 >= 300
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.30
ELSEIF LOCAL:5 >= 100
	TIMES LOCAL:0, 0.60
	TIMES LOCAL:1, 0.70
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.10
ELSEIF LOCAL:5 < -100
	TIMES LOCAL:0, 0.30
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.00
ELSEIF LOCAL:5 < -300
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.30
	TIMES LOCAL:3, 0.90
ELSEIF LOCAL:5 < -500
	TIMES LOCAL:0, 0.10
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.60
	TIMES LOCAL:3, 0.80
ELSE
	TIMES LOCAL:0, 0.05
	TIMES LOCAL:1, 0.05
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 0.70
ENDIF

;欲望による欲情の補正
LOCAL:0 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:0)

CUP:(ARG:0):欲情 += LOCAL:0
CUP:(ARG:0):怒主 -= LOCAL:1
CUP:(ARG:0):哀主 -= LOCAL:1

;好感度上昇
TCVAR:(ARG:0):10 += LOCAL:1 * 10

;依存度上昇
TCVAR:(ARG:0):11 += LOCAL:1 * 10 / 3

;従属度減少
TCVAR:(ARG:0):17 += LOCAL:3 * 10 / 2

;支配度上昇
TCVAR:(ARG:0):74 += LOCAL:1 * 10 * 2 / 3


;-------------------------------------------------
;屈従のソース
;-------------------------------------------------
@CALC_SOURCE13(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):屈従
LOCAL:1 = SOURCE:(ARG:0):屈従
LOCAL:2 = SOURCE:(ARG:0):屈従
LOCAL:3 = SOURCE:(ARG:0):屈従

LOCAL:5 = ABL:(ARG:0):主導度Ｕ
IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_マゾ)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:3, 1.50
ELSEIF LOCAL:5 <= -500
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:3, 1.50
ELSEIF LOCAL:5 <= -300
	TIMES LOCAL:0, 0.60
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.60
	TIMES LOCAL:3, 1.30
ELSEIF LOCAL:5 <= -100
	TIMES LOCAL:0, 0.40
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.70
	TIMES LOCAL:3, 1.10
ELSEIF LOCAL:5 < 100
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 0.80
	TIMES LOCAL:3, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.90
	TIMES LOCAL:3, 0.90
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.40
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 0.80
ELSE
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 0.70
ENDIF

;欲望による欲情の補正
LOCAL:0 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:0)

IF TALENT:(ARG:0):服従
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF
IF TALENT:(ARG:0):隷属
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF
IF TALENT:(ARG:0):烙印
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF

CUP:(ARG:0):欲情 += LOCAL:0
CUP:(ARG:0):怒主 -= LOCAL:1

IF TALENT:(ARG:0):服従 || TALENT:(ARG:0):烙印
	CUP:(ARG:0):哀主 -= LOCAL:1
ENDIF

IF TALENT:(ARG:0):抑圧
	CUP:(ARG:0):哀主 += LOCAL:2
ENDIF

;依存度上昇
TCVAR:(ARG:0):11 += LOCAL:3 * 10 / 3

;従属度上昇
TCVAR:(ARG:0):12 += LOCAL:3 * 10

;支配度現象
TCVAR:(ARG:0):75 += LOCAL:3 * 10 / 2


;-------------------------------------------------
;恐怖のソース
;-------------------------------------------------
@CALC_SOURCE14(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):恐怖

CUP:(ARG:0):怒主 += LOCAL:0 * 3 / 10
CUP:(ARG:0):怖主 += LOCAL:0

;好感度減少
TCVAR:(ARG:0):15 += LOCAL:0

;従属度上昇
TCVAR:(ARG:0):12 += LOCAL:0
;支配度現象
TCVAR:(ARG:0):75 += LOCAL:0 * 10 / 2


;-------------------------------------------------
;反感のソース
;-------------------------------------------------
@CALC_SOURCE15(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):反感

CUP:(ARG:0):怒主 += LOCAL:0
CUP:(ARG:0):哀主 += LOCAL:0 * 3 / 10

;好感度減少
TCVAR:(ARG:0):15 += LOCAL:0

;依存度減少
TCVAR:(ARG:0):16 += LOCAL:0

;従属度減少
TCVAR:(ARG:0):17 += LOCAL:0

;-------------------------------------------------
;不安のソース
;-------------------------------------------------
@CALC_SOURCE16(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):不安

CUP:(ARG:0):怒主 += LOCAL:0 * 3 / 10
CUP:(ARG:0):哀主 += LOCAL:0
CUP:(ARG:0):怖主 += LOCAL:0 * 7 / 10

;好感度減少
TCVAR:(ARG:0):15 += LOCAL:0

;-------------------------------------------------
;接触のソース
;-------------------------------------------------
@CALC_SOURCE17(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):接触
LOCAL:1 = SOURCE:(ARG:0):接触
LOCAL:2 = SOURCE:(ARG:0):接触 / 2
LOCAL:3 = SOURCE:(ARG:0):接触 * 2 / 3

;好感度・従属度・支配度の大きい方を見る
IF ARG:0 != MASTER

	LOCAL:5 = MAX(CFLAG:(ARG:0):2, CFLAG:(ARG:0):4, CFLAG:(ARG:0):支配度)
	IF LOCAL:5 < 100
		TIMES LOCAL:0, 0.00
		TIMES LOCAL:1, 1.20
	ELSEIF LOCAL:5 < 300
		TIMES LOCAL:0, 0.10
		TIMES LOCAL:1, 1.00
	ELSEIF LOCAL:5 < 500
		TIMES LOCAL:0, 0.30
		TIMES LOCAL:1, 0.70
	ELSEIF LOCAL:5 < 800
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 0.30
	ELSEIF LOCAL:5 < 1500
		TIMES LOCAL:0, 0.80
		TIMES LOCAL:1, 0.10
	ELSEIF LOCAL:5 < 3000
		TIMES LOCAL:0, 1.50
		TIMES LOCAL:1, 0.00
	ELSEIF LOCAL:5 < 5000
		TIMES LOCAL:0, 1.40
		TIMES LOCAL:1, 0.00
	ELSE
		TIMES LOCAL:0, 1.50
		TIMES LOCAL:1, 0.00
	ENDIF
ENDIF

;好感度を見る
IF ARG:0 != MASTER
	IF CFLAG:(ARG:0):2 < 100
		TIMES LOCAL:2, 1.00
		TIMES LOCAL:3, 1.00
	ELSEIF CFLAG:(ARG:0):2 < 300
		TIMES LOCAL:2, 0.90
		TIMES LOCAL:3, 0.90
	ELSEIF CFLAG:(ARG:0):2 < 500
		TIMES LOCAL:2, 0.70
		TIMES LOCAL:3, 0.70
	ELSEIF CFLAG:(ARG:0):2 < 800
		TIMES LOCAL:2, 0.30
		TIMES LOCAL:3, 0.30
	ELSEIF CFLAG:(ARG:0):2 < 1500
		TIMES LOCAL:2, 0.15
		TIMES LOCAL:3, 0.15
	ELSE
		TIMES LOCAL:2, 0.00
		TIMES LOCAL:3, 0.00
	ENDIF
ENDIF

IF TALENT:(ARG:0):恥じらい
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 2.00
	TIMES LOCAL:3, 2.00
ENDIF

IF TALENT:(ARG:0):恥薄い
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:3, 0.50
ENDIF

IF TALENT:(ARG:0):恋慕
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:3, 0.20
ENDIF
IF TALENT:(ARG:0):親友
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:3, 0.20
ENDIF
IF TALENT:(ARG:0):親愛
	TIMES LOCAL:0, 2.00
	TIMES LOCAL:1, 0.00
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:3, 0.20
ENDIF
IF TALENT:(ARG:0):恋人
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:3, 0.20
ENDIF

IF IS_MALE(ARG:0)
	TIMES LOCAL:1, 0.75
	TIMES LOCAL:2, 0.75
	TIMES LOCAL:3, 0.75
ENDIF

LOCAL:11 = 1
IF IS_MPLY(ARG:0)
	FOR LOCAL:10, 0, MTAR_NUM
		IF !IS_SAMESEX(ARG:0, MTAR:(LOCAL:10))
			LOCAL:11 = 0
			BREAK
		ENDIF
	NEXT
ELSEIF IS_MTAR(ARG:0)
	FOR LOCAL:10, 0, MPLY_NUM
		IF !IS_SAMESEX(ARG:0, MPLY:(LOCAL:10))
			LOCAL:11 = 0
			BREAK
		ENDIF
	NEXT
ENDIF
IF LOCAL:11
	IF !TALENT:(ARG:0):両刀
		TIMES LOCAL:0, 0.80
	ENDIF
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 0.60
	TIMES LOCAL:3, 0.60
ENDIF

IF IS_SAMESEX(MASTER, ARG:0) || ABL:(ARG:0):性知識 == 0
	IF (!TALENT:(ARG:0):合意 && !FLAG:ウフフフラグ) || ABL:(ARG:0):性知識 == 0
		TIMES LOCAL:0, 0.30
	ENDIF
	TIMES LOCAL:1, 0.30
	TIMES LOCAL:2, 0.30
	TIMES LOCAL:3, 0.50
ENDIF
;好感度上昇
TCVAR:(ARG:0):10 += LOCAL:0 * 3

CUP:(ARG:0):欲情 += LOCAL:0
CUP:(ARG:0):怒主 += LOCAL:1
CUP:(ARG:0):哀主 += LOCAL:2
CUP:(ARG:0):怖主 += LOCAL:3

;-------------------------------------------------
;奉仕のソース
;-------------------------------------------------
@CALC_SOURCE18(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):奉仕
LOCAL:1 = SOURCE:(ARG:0):奉仕
LOCAL:2 = SOURCE:(ARG:0):奉仕

;欲望による欲情の補正
LOCAL:0 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):奉仕
	CASE 0
		TIMES LOCAL:1, 1.00
	CASE 1
		TIMES LOCAL:1, 0.80
	CASE 2
		TIMES LOCAL:1, 0.60
	CASE 3
		TIMES LOCAL:1, 0.40
	CASE 4
		TIMES LOCAL:1, 0.20
	CASEELSE
		TIMES LOCAL:1, 0.10
ENDSELECT

CUP:(ARG:0):欲情 += LOCAL:0
;好感度上昇
TCVAR:(ARG:0):10 += LOCAL:0 / 2

IF TALENT:(ARG:0):抑圧 || TALENT:(ARG:0):孤高
	CUP:(ARG:0):哀主 += LOCAL:1
ENDIF

;-------------------------------------------------
;苦痛のソース
;-------------------------------------------------
@CALC_SOURCE19(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):苦痛
LOCAL:1 = SOURCE:(ARG:0):苦痛
LOCAL:2 = SOURCE:(ARG:0):苦痛
LOCAL:3 = SOURCE:(ARG:0):苦痛
LOCAL:4 = SOURCE:(ARG:0):苦痛 / 5

;好感度と従属度の大きい方を見る
IF ARG:0 != MASTER
	LOCAL:5 = MAX(CFLAG:(ARG:0):2, CFLAG:(ARG:0):4, CFLAG:(ARG:0):支配度)
	IF LOCAL:5 < 100
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 2.00
		TIMES LOCAL:2, 1.00
		TIMES LOCAL:3, 2.00
	ELSEIF LOCAL:5 < 300
		TIMES LOCAL:0, 0.60
		TIMES LOCAL:1, 1.60
		TIMES LOCAL:2, 0.90
		TIMES LOCAL:3, 1.90
	ELSEIF LOCAL:5 < 500
		TIMES LOCAL:0, 0.70
		TIMES LOCAL:1, 1.30
		TIMES LOCAL:2, 0.80
		TIMES LOCAL:3, 1.80
	ELSEIF LOCAL:5 < 800
		TIMES LOCAL:0, 0.80
		TIMES LOCAL:1, 1.00
		TIMES LOCAL:2, 0.70
		TIMES LOCAL:3, 1.60
	ELSEIF LOCAL:5 < 1500
		TIMES LOCAL:0, 1.00
		TIMES LOCAL:1, 0.60
		TIMES LOCAL:2, 0.50
		TIMES LOCAL:3, 1.40
	ELSE
		TIMES LOCAL:0, 1.20
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
		TIMES LOCAL:3, 1.00
	ENDIF
ENDIF

;倒錯度を見る
LOCAL:5 = ABL:(ARG:0):倒錯度
IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_マゾ)
	TIMES LOCAL:0, 1.20
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:4, 0.50
ELSEIF LOCAL:5 >= 800
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.20
	TIMES LOCAL:4, 0.60
ELSEIF LOCAL:5 >= 500
	TIMES LOCAL:0, 0.70
	TIMES LOCAL:1, 0.40
	TIMES LOCAL:2, 0.40
	TIMES LOCAL:4, 0.70
ELSEIF LOCAL:5 >= 300
	TIMES LOCAL:0, 0.30
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 0.60
	TIMES LOCAL:4, 0.80
ELSEIF LOCAL:5 >= 100
	TIMES LOCAL:0, 0.10
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.80
	TIMES LOCAL:4, 0.90
ELSE
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
ENDIF

;ウフフ主導度を見る
LOCAL:5 = ABL:(ARG:0):主導度Ｕ
IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_マゾ)
	TIMES LOCAL:0, 2.00
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
ELSEIF LOCAL:5 <= -500
	TIMES LOCAL:0, 1.60
	TIMES LOCAL:1, 0.70
	TIMES LOCAL:2, 0.70
ELSEIF LOCAL:5 <= -300
	TIMES LOCAL:0, 1.40
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.80
ELSEIF LOCAL:5 <= -100
	TIMES LOCAL:0, 1.20
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.90
ELSEIF LOCAL:5 < 100
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.90
	TIMES LOCAL:1, 1.10
	TIMES LOCAL:2, 1.10
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:1, 1.20
	TIMES LOCAL:2, 1.20
ELSE
	TIMES LOCAL:0, 0.60
	TIMES LOCAL:1, 1.30
	TIMES LOCAL:2, 1.30
ENDIF

;マゾを見る
SELECTCASE ABL:(ARG:0):マゾ
	CASE 0
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 1.10
		TIMES LOCAL:2, 1.10
		TIMES LOCAL:3, 1.10
	CASE 1
		TIMES LOCAL:0, 0.80
		TIMES LOCAL:1, 1.05
		TIMES LOCAL:2, 1.05
		TIMES LOCAL:3, 1.05
	CASE 2
		TIMES LOCAL:0, 1.0
		TIMES LOCAL:1, 1.0
		TIMES LOCAL:2, 1.0
		TIMES LOCAL:3, 1.0
	CASE 3
		TIMES LOCAL:0, 1.1
		TIMES LOCAL:1, 0.80
		TIMES LOCAL:2, 0.80
		TIMES LOCAL:3, 0.80
	CASE 4
		TIMES LOCAL:0, 1.2
		TIMES LOCAL:1, 0.60
		TIMES LOCAL:2, 0.60
		TIMES LOCAL:3, 0.60
	CASEELSE
		LOCAL:0 = LOCAL:0 * ((ABL:(ARG:0):マゾ - 5) * 5 + 140) / 100
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:3, 0.20
		IF TALENT:(ARG:0):抑圧
			TIMES LOCAL:2, 0.50
		ELSE
			TIMES LOCAL:2, 0.20
		ENDIF
ENDSELECT

IF TALENT:(ARG:0):痛みに強い
	TIMES LOCAL:2, 0.80
	TIMES LOCAL:3, 0.70
	TIMES LOCAL:4, 0.70
ENDIF

;痛みに弱い
IF TALENT:(ARG:0):痛みに弱い
	TIMES LOCAL:2, 2.00
	TIMES LOCAL:3, 2.00
	TIMES LOCAL:4, 1.25
ENDIF

;苦痛快楽経験1につき0.1%カット、最大700で70%
LOCAL:4 = LOCAL:4 - LOCAL:4 * MIN(EXP:(ARG:0):苦痛快楽経験, 700) / 1000

;消費量が高すぎる場合の軽減措置(400以降、200おきに超過分を20%減衰)
FOR LOCAL:10, 0, 30
	LOCAL:11 = LOCAL:10 * 200 + 400
	IF LOCAL:4 < LOCAL:11
		BREAK
	ENDIF
	LOCAL:4 = LOCAL:11 + (LOCAL:4 - LOCAL:11) * 4 / 5
NEXT

CUP:(ARG:0):欲情 += LOCAL:0
CUP:(ARG:0):怒主 += LOCAL:1
CUP:(ARG:0):哀主 += LOCAL:2
CUP:(ARG:0):怖主 += LOCAL:3

DOWNBASE:(ARG:0):体力 += LOCAL:4

;-------------------------------------------------
;露出のソース
;-------------------------------------------------
@CALC_SOURCE20(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):露出
LOCAL:1 = SOURCE:(ARG:0):露出
LOCAL:2 = SOURCE:(ARG:0):露出
LOCAL:3 = SOURCE:(ARG:0):露出 / 2

SELECTCASE ABL:(ARG:0):露出
	CASE 0
		TIMES LOCAL:0, 0.00
		TIMES LOCAL:1, 1.00
		TIMES LOCAL:2, 1.00
		TIMES LOCAL:3, 1.00
	CASE 1
		TIMES LOCAL:0, 0.20
		TIMES LOCAL:1, 0.80
		TIMES LOCAL:2, 0.80
		TIMES LOCAL:3, 0.70
	CASE 2
		TIMES LOCAL:0, 0.40
		TIMES LOCAL:1, 0.60
		TIMES LOCAL:2, 0.60
		TIMES LOCAL:3, 0.40
	CASE 3
		TIMES LOCAL:0, 0.70
		TIMES LOCAL:1, 0.40
		TIMES LOCAL:2, 0.40
		TIMES LOCAL:3, 0.20
	CASE 4
		TIMES LOCAL:0, 1.00
		TIMES LOCAL:1, 0.15
		TIMES LOCAL:2, 0.15
		TIMES LOCAL:3, 0.05
	CASEELSE
		LOCAL:0 = LOCAL:0 * ((ABL:(ARG:0):露出 - 5) * 5 + 140) / 100
		TIMES LOCAL:1, 0.05
		TIMES LOCAL:3, 0.00
		IF TALENT:(ARG:0):抑圧
			TIMES LOCAL:2, 0.10
		ELSE
			TIMES LOCAL:2, 0.00
		ENDIF
ENDSELECT

;親密度と依存度の大きい方を見る
LOCAL:5 = MAX(CFLAG:(ARG:0):2, CFLAG:(ARG:0):3)
IF LOCAL:5 < 100
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.90
	TIMES LOCAL:3, 0.90
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:1, 0.70
	TIMES LOCAL:2, 0.70
	TIMES LOCAL:3, 0.80
ELSEIF LOCAL:5 < 800
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:3, 0.60
ELSEIF LOCAL:5 < 1500
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.20
	TIMES LOCAL:3, 0.50
ELSEIF LOCAL:5 < 3000
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.10
	TIMES LOCAL:3, 0.40
ELSE
	TIMES LOCAL:1, 0.05
	TIMES LOCAL:2, 0.05
	TIMES LOCAL:3, 0.30
ENDIF

;恥じらいと恥薄いはここで処理
IF TALENT:(ARG:0):恥じらい
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 1.50
	TIMES LOCAL:3, 2.00
ENDIF
IF TALENT:(ARG:0):恥薄い
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
	TIMES LOCAL:3, 0.50
ENDIF

IF !TALENT:(ARG:0):抑圧
	TIMES LOCAL:2, 0.30
ENDIF

IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_露出狂)
	TIMES LOCAL:0, 1.25
	TIMES LOCAL:1, 0.1
	TIMES LOCAL:2, 0.1
	TIMES LOCAL:3, 0.1
ENDIF

CUP:(ARG:0):欲情 += LOCAL:0
CUP:(ARG:0):怒主 += LOCAL:1
CUP:(ARG:0):哀主 += LOCAL:2
CUP:(ARG:0):怖主 += LOCAL:3

;-------------------------------------------------
;不潔のソース
;-------------------------------------------------
@CALC_SOURCE21(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):不潔

;親密度と依存度の大きい方を見る
LOCAL:5 = MAX(CFLAG:(ARG:0):2, CFLAG:(ARG:0):3)
IF LOCAL:5 < 100
	TIMES LOCAL:0, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.90
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.70
ELSEIF LOCAL:5 < 800
	TIMES LOCAL:0, 0.50
ELSEIF LOCAL:5 < 1500
	TIMES LOCAL:0, 0.20
ELSEIF LOCAL:5 < 3000
	TIMES LOCAL:0, 0.10
ELSE
	TIMES LOCAL:0, 0.05
ENDIF

IF TALENT:(ARG:0):汚れ無視
	TIMES LOCAL:0, 0.00
ELSE
	IF TALENT:(ARG:0):汚臭敏感
		TIMES LOCAL:0, 2.00
	ENDIF
	IF TALENT:(ARG:0):汚臭鈍感
		TIMES LOCAL:0, 0.50
	ENDIF
ENDIF

CUP:(ARG:0):怒主 += LOCAL:0
CUP:(ARG:0):哀主 += LOCAL:0

;好感度減少
TCVAR:(ARG:0):15 += LOCAL:0

;-------------------------------------------------
;逸脱のソース
;-------------------------------------------------
@CALC_SOURCE22(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):逸脱
LOCAL:1 = SOURCE:(ARG:0):逸脱 / 2
LOCAL:2 = SOURCE:(ARG:0):逸脱

;親密度と依存度の大きい方を見る
LOCAL:5 = MAX(CFLAG:(ARG:0):2, CFLAG:(ARG:0):3)
IF LOCAL:5 < 100
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.90
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.90
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.70
	TIMES LOCAL:1, 0.70
	TIMES LOCAL:2, 0.80
ELSEIF LOCAL:5 < 800
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.60
ELSEIF LOCAL:5 < 1500
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.50
ELSEIF LOCAL:5 < 3000
	TIMES LOCAL:0, 0.10
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.40
ELSE
	TIMES LOCAL:0, 0.05
	TIMES LOCAL:1, 0.05
	TIMES LOCAL:2, 0.30
ENDIF

;倒錯度を見る
LOCAL:5 = ABL:(ARG:0):倒錯度
IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_マゾ)
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.00
	TIMES LOCAL:2, 0.05
ELSEIF LOCAL:5 >= 800
	TIMES LOCAL:0, 0.15
	TIMES LOCAL:1, 0.15
	TIMES LOCAL:2, 0.30
ELSEIF LOCAL:5 >= 500
	TIMES LOCAL:0, 0.40
	TIMES LOCAL:1, 0.40
	TIMES LOCAL:2, 0.60
ELSEIF LOCAL:5 >= 300
	TIMES LOCAL:0, 0.60
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 0.80
ELSEIF LOCAL:5 >= 100
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.90
ELSE
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
ENDIF

IF TALENT:(ARG:0):好奇心
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
ENDIF

IF TALENT:(ARG:0):保守的
	TIMES LOCAL:0, 2.00
	TIMES LOCAL:1, 2.00
	TIMES LOCAL:2, 2.00
ENDIF

IF TALENT:(ARG:0):倒錯的
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
ENDIF

CUP:(ARG:0):怒主 += LOCAL:0
CUP:(ARG:0):哀主 += LOCAL:1
CUP:(ARG:0):怖主 += LOCAL:2

;-------------------------------------------------
;嗜虐のソース
;-------------------------------------------------
@CALC_SOURCE23(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):嗜虐 * 2
LOCAL:1 = SOURCE:(ARG:0):嗜虐
LOCAL:2 = SOURCE:(ARG:0):嗜虐
LOCAL:3 = SOURCE:(ARG:0):嗜虐

LOCAL:5 = ABL:(ARG:0):主導度Ｕ
IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_サド)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.80
ELSEIF LOCAL:5 <= -500
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.00
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 0.70
ELSEIF LOCAL:5 <= -300
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.00
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 0.80
ELSEIF LOCAL:5 <= -100
	TIMES LOCAL:0, 0.05
	TIMES LOCAL:1, 0.05
	TIMES LOCAL:2, 1.00
	TIMES LOCAL:3, 0.90
ELSEIF LOCAL:5 < 100
	TIMES LOCAL:0, 0.10
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.70
	TIMES LOCAL:3, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.30
	TIMES LOCAL:1, 0.30
	TIMES LOCAL:2, 0.30
	TIMES LOCAL:3, 1.10
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.60
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 0.05
	TIMES LOCAL:3, 1.30
ELSE
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 0.00
	TIMES LOCAL:3, 1.50
ENDIF

LOCAL:5 = ABL:(ARG:0):倒錯度
IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_サド) || LOCAL:5 >= 800
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 0.10
ELSEIF LOCAL:5 >= 500
	TIMES LOCAL:0, 0.90
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.30
ELSEIF LOCAL:5 >= 300
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.50
ELSEIF LOCAL:5 >= 100
	TIMES LOCAL:0, 0.60
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 0.80
ELSE
	TIMES LOCAL:0, 0.40
	TIMES LOCAL:1, 0.40
	TIMES LOCAL:2, 1.00
ENDIF

;サドを見る
SELECTCASE ABL:(ARG:0):サド
	CASE 0
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 1.10
		TIMES LOCAL:2, 1.10
		TIMES LOCAL:3, 1.10
	CASE 1
		TIMES LOCAL:0, 0.80
		TIMES LOCAL:1, 1.05
		TIMES LOCAL:2, 1.05
		TIMES LOCAL:3, 1.05
	CASE 2
		TIMES LOCAL:0, 1.0
		TIMES LOCAL:1, 1.0
		TIMES LOCAL:2, 1.0
		TIMES LOCAL:3, 1.0
	CASE 3
		TIMES LOCAL:0, 1.1
		TIMES LOCAL:1, 0.80
		TIMES LOCAL:2, 0.80
		TIMES LOCAL:3, 0.80
	CASE 4
		TIMES LOCAL:0, 1.2
		TIMES LOCAL:1, 0.60
		TIMES LOCAL:2, 0.60
		TIMES LOCAL:3, 0.60
	CASEELSE
		LOCAL:0 = LOCAL:0 * ((ABL:(ARG:0):マゾ - 5) * 5 + 140) / 100
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:3, 0.20
		IF TALENT:(ARG:0):抑圧
			TIMES LOCAL:2, 0.50
		ELSE
			TIMES LOCAL:2, 0.20
		ENDIF
ENDSELECT

IF TALENT:(ARG:0):主人
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF
IF TALENT:(ARG:0):所有者
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF

;欲望による欲情の補正
LOCAL:0 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:0)

CUP:(ARG:0):欲情 += LOCAL:0
CUP:(ARG:0):怒主 -= LOCAL:1
CUP:(ARG:0):哀主 -= LOCAL:1
CUP:(ARG:0):怖主 += LOCAL:2

;好感度上昇
TCVAR:(ARG:0):10 += LOCAL:1 * 10

;依存度上昇
TCVAR:(ARG:0):11 += LOCAL:1 * 4

;従属度減少
TCVAR:(ARG:0):17 += LOCAL:3 * 10

;支配度上昇
TCVAR:(ARG:0):74 += LOCAL:1 * 15

;-------------------------------------------------
;感応のソース
;-------------------------------------------------
@CALC_SOURCE24(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):感応
LOCAL:1 = SOURCE:(ARG:0):感応
LOCAL:2 = SOURCE:(ARG:0):感応
LOCAL:3 = SOURCE:(ARG:0):感応

LOCAL:0 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:0)

SELECTCASE ABL:(ARG:0):欲望
	CASE 0
		TIMES LOCAL:1, 1.00
		TIMES LOCAL:2, 1.00
		TIMES LOCAL:3, 1.00
	CASE 1
		TIMES LOCAL:1, 0.85
		TIMES LOCAL:2, 0.85
		TIMES LOCAL:3, 0.85
	CASE 2
		TIMES LOCAL:1, 0.70
		TIMES LOCAL:2, 0.70
		TIMES LOCAL:3, 0.70
	CASE 3
		TIMES LOCAL:1, 0.40
		TIMES LOCAL:2, 0.40
		TIMES LOCAL:3, 0.40
	CASE 4
		TIMES LOCAL:1, 0.30
		TIMES LOCAL:2, 0.30
		TIMES LOCAL:3, 0.30
	CASEELSE
		LOCAL:1 = LOCAL:1 * 2 / (ABL:(ARG:0):欲望 + 15)
		LOCAL:2 = LOCAL:2 * 2 / (ABL:(ARG:0):欲望 + 15)
		LOCAL:3 = LOCAL:3 * 2 / (ABL:(ARG:0):欲望 + 15)
ENDSELECT

IF TALENT:(ARG:0):好奇心
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.50
ENDIF

IF TALENT:(ARG:0):保守的
	TIMES LOCAL:0, 0.75
	TIMES LOCAL:1, 1.50
ENDIF

IF TALENT:(ARG:0):無関心
	TIMES LOCAL:0, 0.30
	TIMES LOCAL:1, 0.30
	TIMES LOCAL:2, 0.30
	TIMES LOCAL:3, 0.30
ENDIF

IF TALENT:(ARG:0):孤高
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 1.50
ENDIF

IF TALENT:(ARG:0):抑圧
	TIMES LOCAL:2, 2.00
ENDIF

IF TALENT:(ARG:0):快感の否定
	TIMES LOCAL:1, 1.30
	TIMES LOCAL:3, 1.30
ENDIF

IF !(TALENT:(ARG:0):孤高 || TALENT:(ARG:0):抑圧 || TALENT:(ARG:0):快感の否定)
	LOCAL:2 = 0
ENDIF

CUP:(ARG:0):欲情 += LOCAL:0
CUP:(ARG:0):怒主 += LOCAL:1 / 6
CUP:(ARG:0):哀主 += LOCAL:2 / 4
CUP:(ARG:0):怖主 += LOCAL:3 / 8

;-------------------------------------------------
;解消のソース
;-------------------------------------------------
@CALC_SOURCE25(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):解消

LOCAL:5 = MAX(PALAM:(ARG:0):怒外, PALAM:(ARG:0):哀外, PALAM:(ARG:0):怖外)

IF LOCAL:5 == PALAM:(ARG:0):怒外
	CUP:(ARG:0):怒外 -= LOCAL:0
ELSEIF LOCAL:5 == PALAM:(ARG:0):哀外
	CUP:(ARG:0):哀外 -= LOCAL:0
ELSE
	CUP:(ARG:0):怖外 -= LOCAL:0
ENDIF

;好感度上昇
TCVAR:(ARG:0):10 += LOCAL:0 * 100 / 15

;依存度上昇
TCVAR:(ARG:0):11 += LOCAL:0 * 100 / 15

;ムードの上昇
TFLAG:37 += LOCAL:0 / 100

;-------------------------------------------------
;歓喜のソース
;-------------------------------------------------
@CALC_SOURCE26(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):歓喜

CUP:(ARG:0):怒主 -= LOCAL:0
CUP:(ARG:0):哀主 -= LOCAL:0
CUP:(ARG:0):怖主 -= LOCAL:0

;-------------------------------------------------
;触手のソース
;-------------------------------------------------
@CALC_SOURCE27(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):触手
LOCAL:1 = SOURCE:(ARG:0):触手 * 2
LOCAL:2 = SOURCE:(ARG:0):触手

SELECTCASE ABL:(ARG:0):触手
	CASE 0
		TIMES LOCAL:0, 1.00
		TIMES LOCAL:1, 1.00
		TIMES LOCAL:2, 0.05
	CASE 1
		TIMES LOCAL:0, 0.80
		TIMES LOCAL:1, 0.90
		TIMES LOCAL:2, 0.15
	CASE 2
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 0.65
		TIMES LOCAL:2, 0.40
	CASE 3
		TIMES LOCAL:0, 0.20
		TIMES LOCAL:1, 0.40
		TIMES LOCAL:2, 0.70
	CASE 4
		TIMES LOCAL:0, 0.05
		TIMES LOCAL:1, 0.20
		TIMES LOCAL:2, 1.00
	CASEELSE
		LOCAL:0 = LOCAL:0 / ((ABL:(ARG:0):触手 - 5) * 100 + 500)
		LOCAL:1 = LOCAL:1 / ((ABL:(ARG:0):触手 - 5) * 50 + 150)
		LOCAL:2 = LOCAL:2 * ((ABL:(ARG:0):触手 - 5) * 10 + 180) / 100
ENDSELECT

SELECTCASE ABL:(ARG:0):欲望
	CASE 0
		TIMES LOCAL:0, 1.00
	CASE 1
		TIMES LOCAL:0, 0.95
	CASE 2
		TIMES LOCAL:0, 0.90
	CASE 3
		TIMES LOCAL:0, 0.80
	CASE 4
		TIMES LOCAL:0, 0.70
	CASEELSE
		LOCAL:0 = LOCAL:0 * 10 / ((ABL:(ARG:0):欲望 - 5) * 3 + 18)
ENDSELECT

LOCAL:5 = ABL:(ARG:0):倒錯度
IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_マゾ) || LOCAL:5 >= 800
	TIMES LOCAL:0, 0.30
	TIMES LOCAL:1, 0.30
	TIMES LOCAL:2, 1.80
ELSEIF LOCAL:5 >= 500
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 1.50
ELSEIF LOCAL:5 >= 300
	TIMES LOCAL:0, 0.70
	TIMES LOCAL:1, 0.70
	TIMES LOCAL:2, 1.30
ELSEIF LOCAL:5 >= 100
	TIMES LOCAL:0, 0.90
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 1.10
ELSE
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
ENDIF

CUP:(ARG:0):怒主 += LOCAL:0
CUP:(ARG:0):哀主 += LOCAL:0 / 2
CUP:(ARG:0):怖主 += LOCAL:1
CUP:(ARG:0):欲情 += CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:2)

;-------------------------------------------------
;主導のソース
;-------------------------------------------------
@CALC_SOURCE28(ARG:0)
;主導度が低いと「悲」が上がる
LOCAL:0 = SOURCE:(ARG:0):主導
LOCAL:1 = SOURCE:(ARG:0):主導
LOCAL:2 = SOURCE:(ARG:0):主導

LOCAL:5 = ABL:(ARG:0):主導度Ｎ
IF LOCAL:5 >= 500 || GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_サド)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.50
ELSEIF LOCAL:5 >= 300
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 1.30
ELSEIF LOCAL:5 >= 100
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.30
	TIMES LOCAL:2, 1.10
ELSEIF LOCAL:5 > -100
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.00
	TIMES LOCAL:2, 1.00
ELSEIF LOCAL:5 > -300
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.90
	LOCAL:1 *= -1
ELSEIF LOCAL:5 > -500
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 0.80
	LOCAL:1 *= -1
ELSE
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 0.70
	LOCAL:1 *= -1
ENDIF

IF TALENT:(ARG:0):主人
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF
IF TALENT:(ARG:0):所有者
	TIMES LOCAL:0, 1.30
	TIMES LOCAL:1, 1.30
ENDIF

CUP:(ARG:0):怒主 -= LOCAL:0
CUP:(ARG:0):哀主 -= LOCAL:1

;好感度上昇
TCVAR:(ARG:0):10 += (LOCAL:0 + LOCAL:1) * 3

;従属度減少
TCVAR:(ARG:0):17 += LOCAL:2 * 2

;支配度上昇
TCVAR:(ARG:0):74 += (LOCAL:0 + LOCAL:1) * 3 / 2

;-------------------------------------------------
;受動のソース
;-------------------------------------------------
@CALC_SOURCE29(ARG:0)
;主導度が高いと「怒」が上がる
LOCAL:0 = SOURCE:(ARG:0):受動
LOCAL:1 = SOURCE:(ARG:0):受動
LOCAL:2 = SOURCE:(ARG:0):受動

LOCAL:5 = ABL:(ARG:0):主導度Ｎ
IF LOCAL:5 <= -500 || GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_マゾ)
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.50
ELSEIF LOCAL:5 <= -300
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 0.60
	TIMES LOCAL:2, 1.30
ELSEIF LOCAL:5 <= -100
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.30
	TIMES LOCAL:2, 1.10
ELSEIF LOCAL:5 < 100
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.00
	TIMES LOCAL:2, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.90
	LOCAL:1 *= -1
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 0.80
	LOCAL:1 *= -1
ELSE
	TIMES LOCAL:0, 0.00
	TIMES LOCAL:1, 1.50
	TIMES LOCAL:2, 0.70
	LOCAL:1 *= -1
ENDIF

CUP:(ARG:0):怒主 -= LOCAL:1
CUP:(ARG:0):哀主 -= LOCAL:0

;好感度上昇
TCVAR:(ARG:0):10 += (LOCAL:0 + LOCAL:1) * 2

;従属度上昇
TCVAR:(ARG:0):12 += LOCAL:2 * 2

;支配度減少
TCVAR:(ARG:0):75 += LOCAL:2 / 3


;-------------------------------------------------
;中毒充足のソース
;-------------------------------------------------
@CALC_SOURCE30(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):中毒充足 * 5
LOCAL:1 = SOURCE:(ARG:0):中毒充足

LOCAL:0 = CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:0)

CUP:(ARG:0):欲情 += LOCAL:0
CUP:(ARG:0):怒主 -= LOCAL:1
CUP:(ARG:0):哀主 -= LOCAL:1
CUP:(ARG:0):怖主 -= LOCAL:1 * 2 / 3

;好感度上昇
TCVAR:(ARG:0):10 += LOCAL:1 / 6

;依存度上昇
TCVAR:(ARG:0):11 += LOCAL:1 / 2

;-------------------------------------------------
;悲哀のソース
;-------------------------------------------------
@CALC_SOURCE31(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):悲哀

CUP:(ARG:0):怒主 += LOCAL:0 / 5
CUP:(ARG:0):哀主 += LOCAL:0

;好感度減少
TCVAR:(ARG:0):15 += LOCAL:0 / 5

;依存度減少
TCVAR:(ARG:0):16 += LOCAL:0 / 3

;従属度減少
TCVAR:(ARG:0):17 += LOCAL:0 / 5

;支配度減少
TCVAR:(ARG:0):75 += LOCAL:0 / 6


;-------------------------------------------------
;不満のソース
;-------------------------------------------------
@CALC_SOURCE32(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):不満

CUP:(ARG:0):怒主 += LOCAL:0 / 10
CUP:(ARG:0):哀主 += LOCAL:0 / 10

;好感度減少
TCVAR:(ARG:0):15 += LOCAL:0

;依存度減少
TCVAR:(ARG:0):16 += LOCAL:0 / 2

;従属度減少
TCVAR:(ARG:0):17 += LOCAL:0 / 3

;支配度減少
TCVAR:(ARG:0):75 += LOCAL:0 / 4

;-------------------------------------------------
;性行動のソース
;-------------------------------------------------
@CALC_SOURCE33(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):性行動
LOCAL:1 = SOURCE:(ARG:0):性行動
LOCAL:2 = SOURCE:(ARG:0):性行動
LOCAL:3 = SOURCE:(ARG:0):性行動

SELECTCASE ABL:(ARG:0):欲望
	CASE 0
		TIMES LOCAL:0, 1.00
		TIMES LOCAL:1, 1.00
	CASE 1
		TIMES LOCAL:0, 0.90
		TIMES LOCAL:1, 0.80
	CASE 2
		TIMES LOCAL:0, 0.75
		TIMES LOCAL:1, 0.50
	CASE 3
		TIMES LOCAL:0, 0.60
		TIMES LOCAL:1, 0.25
	CASE 4
		TIMES LOCAL:0, 0.50
		TIMES LOCAL:1, 0.10
	CASEELSE
		LOCAL:0 = LOCAL:0 * 4 / (ABL:(ARG:0):欲望 + 5)
		LOCAL:1 = LOCAL:1 / ((ABL:(ARG:0):欲望 + 5) * 2)
ENDSELECT

;親密度と依存度の大きい方を見る
LOCAL:5 = MAX(CFLAG:(ARG:0):2, CFLAG:(ARG:0):3)
IF LOCAL:5 < 100
	TIMES LOCAL:0, 1.00
	TIMES LOCAL:1, 1.00
	TIMES LOCAL:2, 1.00
ELSEIF LOCAL:5 < 300
	TIMES LOCAL:0, 0.90
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.90
ELSEIF LOCAL:5 < 500
	TIMES LOCAL:0, 0.70
	TIMES LOCAL:1, 0.70
	TIMES LOCAL:2, 0.80
ELSEIF LOCAL:5 < 800
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.60
ELSEIF LOCAL:5 < 1500
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.20
	TIMES LOCAL:2, 0.50
ELSEIF LOCAL:5 < 3000
	TIMES LOCAL:0, 0.10
	TIMES LOCAL:1, 0.10
	TIMES LOCAL:2, 0.40
ELSE
	TIMES LOCAL:0, 0.05
	TIMES LOCAL:1, 0.05
	TIMES LOCAL:2, 0.30
ENDIF

IF TALENT:(ARG:0):快感の否定
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:2, 1.50
ENDIF

IF TALENT:(ARG:0):保守的
	TIMES LOCAL:0, 1.50
	TIMES LOCAL:2, 1.50
ENDIF

IF TALENT:(ARG:0):好奇心
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:2, 0.80
ENDIF

IF TALENT:(ARG:0):プライド高い
	TIMES LOCAL:0, 1.20
ELSEIF TALENT:(ARG:0):プライド低い
	TIMES LOCAL:0, 0.80
ENDIF

IF TALENT:(ARG:0):親愛
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.20
ELSEIF TALENT:(ARG:0):恋慕
	TIMES LOCAL:0, 0.40
	TIMES LOCAL:1, 0.75
	TIMES LOCAL:2, 0.40
ENDIF

IF TALENT:(ARG:0):恋人
	TIMES LOCAL:0, 0.70
	TIMES LOCAL:1, 0.80
	TIMES LOCAL:2, 0.70
ENDIF

IF TALENT:(ARG:0):隷属
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:2, 0.10
ELSEIF TALENT:(ARG:0):服従
	TIMES LOCAL:0, 0.40
	TIMES LOCAL:2, 0.25
ENDIF

IF TALENT:(ARG:0):烙印
	TIMES LOCAL:0, 0.70
	TIMES LOCAL:2, 0.70
ENDIF

IF IS_FALLEN_TO_SP_COUNTRY(ARG:0)
	TIMES LOCAL:0, 0.20
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.30
ENDIF

IF TALENT:(ARG:0):合意
	TIMES LOCAL:0, 0.40
	TIMES LOCAL:1, 0.50
	TIMES LOCAL:2, 0.40
ELSE
	IF TALENT:(ARG:0):貞操観念
		TIMES LOCAL:0, 1.50
		TIMES LOCAL:2, 1.50
	ENDIF
	IF TALENT:(ARG:0):貞操無頓着
		TIMES LOCAL:0, 0.75
		TIMES LOCAL:2, 0.75
	ENDIF
ENDIF

IF TALENT:(ARG:0):性別 == 0
	TIMES LOCAL:0, 0.50
	TIMES LOCAL:1, 0.50
ELSEIF GROUPMATCH(TALENT:(ARG:0):性別, 3, 4, 5)
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:1, 0.80
ENDIF

;桃源香使用中
IF TFLAG:69
	TIMES LOCAL:0, 0.80
	TIMES LOCAL:1, 0.90
	TIMES LOCAL:2, 0.80
ENDIF

IF ABL:(ARG:0):性知識 == 0
	LOCAL:0 = 0
ENDIF

IF !TALENT:(ARG:0):孤高 && !TALENT:(ARG:0):抑圧
	LOCAL:2 = 0
ENDIF

CUP:(ARG:0):欲情 += CALC_SOURCE_YOKUBOU(ARG:0, LOCAL:3 / 2)

CUP:(ARG:0):怒主 += LOCAL:0
CUP:(ARG:0):哀主 += LOCAL:0
CUP:(ARG:0):怖主 += LOCAL:1

;好感度減少
TCVAR:(ARG:0):15 += LOCAL:0

;依存度減少
TCVAR:(ARG:0):16 += LOCAL:2 / 3

;従属度減少
TCVAR:(ARG:0):17 += LOCAL:2 / 2

;支配度減少
TCVAR:(ARG:0):75 += LOCAL:2 / 2


;-------------------------------------------------
;液体追加のソース
;-------------------------------------------------
@CALC_SOURCE40(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):液体追加

CUP:(ARG:0):潤滑 += LOCAL:0

;-------------------------------------------------
;欲情追加のソース
;-------------------------------------------------
@CALC_SOURCE41(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):欲情追加

CUP:(ARG:0):欲情 += LOCAL:0

;-------------------------------------------------
;酔い追加のソース
;-------------------------------------------------
@CALC_SOURCE50(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):酔い追加


IF TALENT:(ARG:0):酒豪
	TIMES LOCAL:0, 0.8
ELSEIF TALENT:(ARG:0):下戸
	TIMES LOCAL:0, 1.2
ELSE
	IF TALENT:(ARG:0):幼児
		TIMES LOCAL:0, 3.00
	ELSEIF TALENT:(ARG:0):体格 == 体格_小柄
		TIMES LOCAL:0, 1.50
	ENDIF
ENDIF

CUP:(ARG:0):酔い += LOCAL:0


;-------------------------------------------------
;薬物追加のソース
;-------------------------------------------------
@CALC_SOURCE52(ARG:0)
LOCAL:0 = SOURCE:(ARG:0):薬物追加
IF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_薬物中毒)
	TIMES LOCAL:0, 0.50
ELSE
	IF TALENT:(ARG:0):幼児
		TIMES LOCAL:0, 3.00
	ELSEIF TALENT:(ARG:0):体格 == 体格_小柄
		TIMES LOCAL:0, 1.50
	ENDIF
ENDIF

CUP:(ARG:0):薬物 += LOCAL:0
;-------------------------------------------------
;欲望による欲情の共通補正 ARG:0=キャラ番号、ARG:1=欲情上昇の基本値
;-------------------------------------------------
@CALC_SOURCE_YOKUBOU(ARG:0, ARG:1)
#FUNCTION
LOCAL:0 = ARG:1

;媚薬使用中
IF TCVAR:(ARG:0):60
	TIMES LOCAL:0, 2.00
ENDIF

;桃源香使用中
IF TFLAG:69
	TIMES LOCAL:0, 1.25
ENDIF

SELECTCASE ABL:(ARG:0):欲望
	CASE 0
		TIMES LOCAL:0, 0.40
	CASE 1
		TIMES LOCAL:0, 0.80
	CASE 2
		TIMES LOCAL:0, 1.60
	CASE 3
		TIMES LOCAL:0, 2.50
	CASE 4
		TIMES LOCAL:0, 4.00
	CASEELSE
		LOCAL:0 = LOCAL:0 * ((ABL:(ARG:0):欲望 - 5) * 2 + 60) / 10
ENDSELECT
RETURNF LOCAL:0

;-------------------------------------------------
;対応する感覚レベルによる快楽ソースへの補正
;ARG:0=感覚の値
;ARG:1=現在の快感ソース
;-------------------------------------------------
@CALC_SOURCE_SENSE_BASE(ARG:0, ARG:1)
#FUNCTION
LOCAL:0 = ARG:1
LOCAL:1 = ARG:1
SELECTCASE ARG:0
	CASE 0
		TIMES LOCAL:0, 0.6
	CASE 1
		TIMES LOCAL:0, 0.8
	CASE 2
		TIMES LOCAL:0, 1.0
	CASE 3
		TIMES LOCAL:0, 1.5
	CASE 4
		TIMES LOCAL:0, 2.0
	CASEELSE
		LOCAL:0 = LOCAL:0 * ((ARG:0 - 4) * 80 + 200) / 100
ENDSELECT
RETURNF LOCAL:0
;-------------------------------------------------
;欲情による快感量の共通補正 ARG:0=キャラ番号、ARG:1=欲情上昇の基本値
;-------------------------------------------------
@CALC_SOURCE_SENSE_ESTRUS(ARG:0, ARG:1)
#FUNCTION
LOCAL:0 = ARG:1
IF PALAM:(ARG:0):欲情 < PALAMLV:1
	TIMES LOCAL:0, 0.30
ELSEIF PALAM:(ARG:0):欲情 < PALAMLV:2
	TIMES LOCAL:0, 0.40
ELSEIF PALAM:(ARG:0):欲情 < PALAMLV:3
	TIMES LOCAL:0, 0.60
ELSEIF PALAM:(ARG:0):欲情 < PALAMLV:4
	TIMES LOCAL:0, 0.80
ELSEIF PALAM:(ARG:0):欲情 < PALAMLV:5
	TIMES LOCAL:0, 1.00
ELSEIF PALAM:(ARG:0):欲情 < PALAMLV:6
	TIMES LOCAL:0, 1.05
ELSEIF PALAM:(ARG:0):欲情 < PALAMLV:7
	TIMES LOCAL:0, 1.10
ELSEIF PALAM:(ARG:0):欲情 < PALAMLV:8
	TIMES LOCAL:0, 1.20
ELSEIF PALAM:(ARG:0):欲情 < PALAMLV:9
	TIMES LOCAL:0, 1.30
ELSE
	TIMES LOCAL:0, 1.40
ENDIF
RETURNF LOCAL:0

;-------------------------------------------------
;噴乳上昇量の共通補正 ARG:0=キャラ番号、ARG:1=噴乳上昇の基本値
;-------------------------------------------------
@CALC_SOURCE_MILK(ARG:0, ARG:1)
#FUNCTION
LOCAL:0 = ARG:1
SELECTCASE ABL:(ARG:0):噴乳
	CASE 0
		TIMES LOCAL:0, 1.00
	CASE 1
		TIMES LOCAL:0, 1.15
	CASE 2
		TIMES LOCAL:0, 1.30
	CASE 3
		TIMES LOCAL:0, 1.50
	CASE 4
		TIMES LOCAL:0, 2.0
	CASEELSE
		LOCAL:0 = LOCAL:0 * MIN(ABL:(ARG:0):噴乳 * 50, 1000) / 100
ENDSELECT
SIF GETBIT(TALENT:(ARG:0):淫乱系, 素質_淫乱_雌牛)
	TIMES LOCAL, 1.5
RETURNF LOCAL:0
